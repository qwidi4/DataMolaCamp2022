CREATE TABLE FCT_SALES
(
    sale_id NUMBER(10),
    product_id NUMBER(10),
    store_id NUMBER(10),
    date_id DATE
)
PARTITION BY HASH (date_id)
(
    PARTITION Part_1 TABLESPACE TS_REFERENCES_EXT_DATA_01,
    PARTITION Part_2 TABLESPACE TS_REFERENCES_EXT_DATA_01,
    PARTITION Part_3 TABLESPACE TS_REFERENCES_EXT_DATA_01,
    PARTITION Part_4 TABLESPACE TS_REFERENCES_EXT_DATA_01
);

INSERT INTO FCT_SALES VALUES (1, 3, 1 ,to_date('01/01/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (2, 6, 2 ,to_date('15/02/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (3, 2, 3 ,to_date('31/03/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (4, 3, 2 ,to_date('07/04/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (5, 1, 1 ,to_date('20/05/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (6, 1, 7 ,to_date('13/06/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (7, 5, 4 ,to_date('03/07/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (8, 3, 2 ,to_date('27/08/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (9, 2, 1 ,to_date('21/09/2022','DD/MM/YYYY'));
commit;

SELECT * FROM fct_sales PARTITION(Part_1);
SELECT * FROM fct_sales PARTITION(Part_2);
SELECT * FROM fct_sales PARTITION(Part_3);
SELECT * FROM fct_sales PARTITION(Part_4);

DROP TABLE FCT_SALES;

CREATE TABLE FCT_SALES
(
    sale_id NUMBER(10),
    product_id NUMBER(10),
    store_id NUMBER(10),
    date_id DATE
)
PARTITION BY RANGE (date_id)
(
    PARTITION Part_1 VALUES LESS THAN (TO_DATE('01/03/2022','DD/MM/YYYY')),
    PARTITION Part_2 VALUES LESS THAN (TO_DATE('01/06/2022','DD/MM/YYYY')),
    PARTITION Part_3 VALUES LESS THAN (TO_DATE('01/09/2022','DD/MM/YYYY')),
    PARTITION Part_4 VALUES LESS THAN (TO_DATE('01/01/2023','DD/MM/YYYY'))
)TABLESPACE TS_REFERENCES_EXT_DATA_01;

INSERT INTO FCT_SALES VALUES (1, 3, 1 ,to_date('01/01/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (2, 6, 2 ,to_date('15/02/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (3, 2, 3 ,to_date('31/03/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (4, 3, 2 ,to_date('07/04/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (5, 1, 1 ,to_date('20/05/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (6, 1, 7 ,to_date('13/06/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (7, 5, 4 ,to_date('03/07/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (8, 3, 2 ,to_date('27/08/2022','DD/MM/YYYY'));
INSERT INTO FCT_SALES VALUES (9, 2, 1 ,to_date('21/09/2022','DD/MM/YYYY'));
commit;

SELECT * FROM fct_sales PARTITION(Part_1);
SELECT * FROM fct_sales PARTITION(Part_2);
SELECT * FROM fct_sales PARTITION(Part_3);
SELECT * FROM fct_sales PARTITION(Part_4);

DROP TABLE FCT_SALES;




